<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ph√¢n t√≠ch Database & API - Quiz AI</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4f46e5;
            --secondary-color: #10b981;
            --background-color: #f8fafc;
            --card-background: #ffffff;
            --text-color: #334155;
            --heading-color: #1e293b;
            --border-color: #e2e8f0;
            --shadow-color: rgba(99, 102, 241, 0.1);
            --method-get: #0ea5e9;
            --method-post: #22c55e;
            --method-put: #f97316;
            --method-delete: #ef4444;
            --method-ws: #8b5cf6;
        }

        body {
            font-family: 'Be Vietnam Pro', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.7;
            margin: 0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .header {
            text-align: center;
            margin-bottom: 3rem;
            padding: 2rem;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 16px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 700px;
            margin: 0 auto;
        }

        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .tab-button {
            padding: 0.75rem 1.5rem;
            background: var(--card-background);
            border: 1px solid var(--border-color);
            border-radius: 999px;
            color: var(--text-color);
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px var(--shadow-color);
        }

        .tab-button:hover {
            background-color: var(--primary-color);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px var(--shadow-color);
        }

        .tab-button.active {
            background-color: var(--primary-color);
            color: white;
            font-weight: 700;
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.2);
        }

        .tab-content {
            display: none;
            background: var(--card-background);
            border-radius: 16px;
            padding: 2rem;
            border: 1px solid var(--border-color);
            box-shadow: 0 8px 16px var(--shadow-color);
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .diagram-container {
            text-align: center;
            padding: 1rem;
            background: #f1f5f9;
            border-radius: 12px;
            overflow: auto;
        }

        .mermaid {
            margin: 0 auto;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1.5rem;
        }

        .card {
            background: var(--card-background);
            padding: 1.5rem;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px var(--shadow-color);
        }

        .card h3 {
            color: var(--primary-color);
            margin-top: 0;
            margin-bottom: 1rem;
            font-size: 1.25rem;
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 0.5rem;
        }

        .card ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .card li {
            padding: 0.6rem 0;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .card li:last-child {
            border-bottom: none;
        }

        .card code {
            background-color: #eef2ff;
            color: var(--primary-color);
            padding: 0.2em 0.5em;
            margin: 0;
            font-size: .9em;
            border-radius: 5px;
            font-weight: 500;
            word-break: break-all;
        }

        .feature-card {
            text-align: center;
        }

        .feature-icon {
            font-size: 3rem;
            line-height: 1;
            margin-bottom: 1rem;
            display: inline-block;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .api-method {
            font-weight: 700;
            padding: 0.2rem 0.6rem;
            border-radius: 5px;
            color: white;
            font-size: 0.8rem;
            min-width: 55px;
            text-align: center;
        }
        .method-get { background-color: var(--method-get); }
        .method-post { background-color: var(--method-post); }
        .method-put { background-color: var(--method-put); }
        .method-delete { background-color: var(--method-delete); }
        .method-ws { background-color: var(--method-ws); }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            .header h1 {
                font-size: 2rem;
            }
            .tabs {
                flex-direction: column;
                align-items: stretch;
            }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>Ph√¢n t√≠ch To√†n di·ªán H·ªá th·ªëng Quiz AI</h1>
        <p>T√†i li·ªáu n√†y m√¥ t·∫£ ki·∫øn tr√∫c c∆° s·ªü d·ªØ li·ªáu, c√°c API endpoints v√† ch·ª©c nƒÉng ch√≠nh, cung c·∫•p m·ªôt c√°i nh√¨n t·ªïng th·ªÉ v·ªÅ c√°ch h·ªá th·ªëng ho·∫°t ƒë·ªông.</p>
    </div>

    <div class="tabs">
        <button class="tab-button active" onclick="showTab('diagram')">üìä S∆° ƒë·ªì Quan h·ªá</button>
        <button class="tab-button" onclick="showTab('tables')">üìã Chi ti·∫øt B·∫£ng</button>
        <button class="tab-button" onclick="showTab('features')">üöÄ Ch·ª©c nƒÉng Ch√≠nh</button>
        <button class="tab-button" onclick="showTab('api')">üîå API Endpoints</button>
    </div>

    <div id="diagram" class="tab-content active">
        <h2>S∆° ƒë·ªì Quan h·ªá Th·ª±c th·ªÉ (ERD)</h2>
        <p>Bi·ªÉu ƒë·ªì d∆∞·ªõi ƒë√¢y minh h·ªça m·ªëi quan h·ªá gi·ªØa c√°c b·∫£ng ch√≠nh trong c∆° s·ªü d·ªØ li·ªáu.</p>
        <div class="diagram-container">
            <div class="mermaid">
                erDiagram
                users { int id PK, varchar username, varchar email, varchar full_name }
                categories { int id PK, varchar name }
                uploaded_files { int id PK, int user_id FK, varchar original_filename, boolean is_processed, boolean is_public, vector content_embedding }
                knowledge_base { int id PK, varchar title, enum source_type, int created_by FK, boolean is_public, vector content_embedding }
                quizzes { int id PK, int creator_id FK, varchar title, int category_id FK, enum source_type, boolean is_public, varchar share_link, vector content_embedding }
                questions { int id PK, int quiz_id FK, text question_text, enum question_type, vector question_embedding }
                answers { int id PK, int question_id FK, text answer_text, boolean is_correct }
                quiz_attempts { int id PK, int quiz_id FK, int user_id FK, decimal percentage_score, boolean is_completed }
                quiz_responses { int id PK, int attempt_id FK, int question_id FK, int answer_id FK, boolean is_correct }
                content_permissions { int id PK, enum content_type, int content_id, int owner_id FK, int shared_with_user_id FK, enum permission_type }
                ai_processing_logs { int id PK, int quiz_id FK, int file_id FK, int knowledge_base_id FK, enum process_type, enum status }

                users ||--o{ quizzes : "t·∫°o"
                users ||--o{ uploaded_files : "upload"
                users ||--o{ knowledge_base : "t·∫°o"
                users ||--o{ quiz_attempts : "tham gia"
                users ||--o{ content_permissions : "s·ªü h·ªØu/chia s·∫ª"
                categories ||--o{ quizzes : "thu·ªôc"
                categories ||--o{ knowledge_base : "thu·ªôc"
                quizzes ||--o{ questions : "ch·ª©a"
                quizzes ||--o{ quiz_attempts : "c√≥ l∆∞·ª£t l√†m"
                quizzes ||--o{ ai_processing_logs : "ƒë∆∞·ª£c x·ª≠ l√Ω"
                questions ||--o{ answers : "c√≥"
                questions ||--o{ quiz_responses : "ƒë∆∞·ª£c tr·∫£ l·ªùi"
                quiz_attempts ||--o{ quiz_responses : "c√≥"
                answers }o--|| quiz_responses : "ƒë∆∞·ª£c ch·ªçn"
                uploaded_files ||--o{ ai_processing_logs : "ƒë∆∞·ª£c x·ª≠ l√Ω"
                knowledge_base ||--o{ ai_processing_logs : "ƒë∆∞·ª£c x·ª≠ l√Ω"
            </div>
        </div>
    </div>

    <div id="tables" class="tab-content">
        <h2>M√¥ t·∫£ Chi ti·∫øt c√°c B·∫£ng</h2>
        <p>D∆∞·ªõi ƒë√¢y l√† vai tr√≤ c·ªßa t·ª´ng b·∫£ng trong vi·ªác l∆∞u tr·ªØ v√† qu·∫£n l√Ω d·ªØ li·ªáu c·ªßa h·ªá th·ªëng.</p>
        <div class="grid-container">
            <div class="card"><h3>üë• Qu·∫£n l√Ω Ng∆∞·ªùi d√πng & N·ªôi dung</h3><ul><li><code>users</code>: L∆∞u th√¥ng tin t√†i kho·∫£n ng∆∞·ªùi d√πng.</li><li><code>categories</code>: Ph√¢n lo·∫°i c√°c ch·ªß ƒë·ªÅ cho quiz v√† knowledge base.</li><li><code>uploaded_files</code>: Qu·∫£n l√Ω c√°c file do ng∆∞·ªùi d√πng t·∫£i l√™n (PDF, DOCX) ƒë·ªÉ t·∫°o quiz.</li><li><code>knowledge_base</code>: C∆° s·ªü tri th·ª©c ƒë∆∞·ª£c chia s·∫ª, d√πng ƒë·ªÉ t·∫°o quiz ho·∫∑c tham kh·∫£o.</li></ul></div>
            <div class="card"><h3>üìù Qu·∫£n l√Ω Quiz</h3><ul><li><code>quizzes</code>: B·∫£ng trung t√¢m, l∆∞u th√¥ng tin ch√≠nh c·ªßa m·ªói b·ªô c√¢u h·ªèi (quiz).</li><li><code>questions</code>: L∆∞u tr·ªØ t·ª´ng c√¢u h·ªèi thu·ªôc m·ªôt quiz.</li><li><code>answers</code>: L∆∞u c√°c l·ª±a ch·ªçn tr·∫£ l·ªùi cho m·ªói c√¢u h·ªèi tr·∫Øc nghi·ªám.</li></ul></div>
            <div class="card"><h3>üéØ T∆∞∆°ng t√°c & K·∫øt qu·∫£</h3><ul><li><code>quiz_attempts</code>: Ghi l·∫°i m·ªói l∆∞·ª£t l√†m b√†i c·ªßa ng∆∞·ªùi d√πng.</li><li><code>quiz_responses</code>: L∆∞u chi ti·∫øt c√¢u tr·∫£ l·ªùi c·ªßa ng∆∞·ªùi d√πng cho t·ª´ng c√¢u h·ªèi trong m·ªôt l∆∞·ª£t l√†m b√†i.</li></ul></div>
            <div class="card"><h3>ü§ñ AI & H·ªá th·ªëng</h3><ul><li><code>ai_processing_logs</code>: Ghi l·∫°i nh·∫≠t k√Ω c√°c t√°c v·ª• x·ª≠ l√Ω c·ªßa AI (t·∫°o c√¢u h·ªèi, t·∫°o embedding...).</li><li><code>content_permissions</code>: Qu·∫£n l√Ω quy·ªÅn truy c·∫≠p chi ti·∫øt (xem, s·ª≠a, sao ch√©p) cho quiz, file v√† knowledge base.</li></ul></div>
        </div>
    </div>

    <div id="features" class="tab-content">
        <h2>T·ªïng quan Ch·ª©c nƒÉng Ch√≠nh</h2>
        <p>Ki·∫øn tr√∫c database v√† API n√†y h·ªó tr·ª£ m·ªôt lo·∫°t c√°c t√≠nh nƒÉng m·∫°nh m·∫Ω v√† th√¥ng minh.</p>
        <div class="grid-container">
            <div class="card feature-card"><div class="feature-icon">üß†</div><h3>T·∫°o Quiz b·∫±ng AI</h3><p>T·ª± ƒë·ªông sinh c√¢u h·ªèi v√† t√≥m t·∫Øt n·ªôi dung t·ª´ file PDF, DOCX ho·∫∑c vƒÉn b·∫£n ng∆∞·ªùi d√πng nh·∫≠p v√†o.</p></div>
            <div class="card feature-card"><div class="feature-icon">üîç</div><h3>T√¨m ki·∫øm Ng·ªØ nghƒ©a</h3><p>S·ª≠ d·ª•ng vector embeddings ƒë·ªÉ t√¨m ki·∫øm c√°c quiz, c√¢u h·ªèi, ho·∫∑c ki·∫øn th·ª©c t∆∞∆°ng t·ª± d·ª±a tr√™n √Ω nghƒ©a, kh√¥ng ch·ªâ t·ª´ kh√≥a.</p></div>
            <div class="card feature-card"><div class="feature-icon">üîÑ</div><h3>C∆° s·ªü tri th·ª©c & T√°i s·ª≠ d·ª•ng</h3><p>X√¢y d·ª±ng m·ªôt kho ki·∫øn th·ª©c chung (Knowledge Base) t·ª´ c√°c file v√† quiz, cho ph√©p ng∆∞·ªùi d√πng kh√°c t√°i s·ª≠ d·ª•ng ƒë·ªÉ t·∫°o quiz m·ªõi.</p></div>
            <div class="card feature-card"><div class="feature-icon">ü§ù</div><h3>Chia s·∫ª & Ph√¢n quy·ªÅn</h3><p>Chia s·∫ª quiz c√¥ng khai ho·∫∑c ri√™ng t∆∞, cho ph√©p sao ch√©p, v√† qu·∫£n l√Ω quy·ªÅn truy c·∫≠p chi ti·∫øt cho t·ª´ng ng∆∞·ªùi d√πng.</p></div>
            <div class="card feature-card"><div class="feature-icon">üìà</div><h3>Th·ªëng k√™ & Ph√¢n t√≠ch</h3><p>Cung c·∫•p c√°c View v√† API ƒë·ªÉ d·ªÖ d√†ng truy v·∫•n th·ªëng k√™ v·ªÅ t·ªâ l·ªá ho√†n th√†nh, ƒëi·ªÉm trung b√¨nh, v√† b·∫£ng x·∫øp h·∫°ng.</p></div>
            <div class="card feature-card"><div class="feature-icon">‚öôÔ∏è</div><h3>Linh ho·∫°t & M·ªü r·ªông</h3><p>H·ªó tr·ª£ nhi·ªÅu lo·∫°i c√¢u h·ªèi, t√πy ch·ªânh linh ho·∫°t cho t·ª´ng quiz (gi·ªõi h·∫°n th·ªùi gian, s·ªë l·∫ßn l√†m b√†i) v√† d·ªÖ d√†ng m·ªü r·ªông trong t∆∞∆°ng lai.</p></div>
        </div>
    </div>

    <div id="api" class="tab-content">
        <h2>Danh s√°ch API Endpoints</h2>
        <p>C√°c API ƒë∆∞·ª£c nh√≥m theo ch·ª©c nƒÉng ƒë·ªÉ th·ª±c hi·ªán c√°c ho·∫°t ƒë·ªông tr√™n h·ªá th·ªëng.</p>
        <div class="grid-container">
            <div class="card"><h3>1. Authentication & User</h3><ul><li><span class="api-method method-post">POST</span><code>/api/auth/register</code> - ƒêƒÉng k√Ω</li><li><span class="api-method method-post">POST</span><code>/api/auth/login</code> - ƒêƒÉng nh·∫≠p</li><li><span class="api-method method-get">GET</span><code>/api/users/profile</code> - L·∫•y th√¥ng tin c√° nh√¢n</li><li><span class="api-method method-put">PUT</span><code>/api/users/profile</code> - C·∫≠p nh·∫≠t th√¥ng tin</li></ul></div>
            <div class="card"><h3>2. File & AI Processing</h3><ul><li><span class="api-method method-post">POST</span><code>/api/files/upload</code> - T·∫£i file l√™n</li><li><span class="api-method method-get">GET</span><code>/api/files</code> - L·∫•y danh s√°ch file</li><li><span class="api-method method-post">POST</span><code>/api/ai/generate-questions</code> - Sinh c√¢u h·ªèi t·ª´ n·ªôi dung</li><li><span class="api-method method-post">POST</span><code>/api/ai/generate-embeddings</code> - T·∫°o vector embedding</li></ul></div>
            <div class="card"><h3>3. Knowledge Base</h3><ul><li><span class="api-method method-get">GET</span><code>/api/knowledge-base</code> - L·∫•y danh s√°ch</li><li><span class="api-method method-post">POST</span><code>/api/knowledge-base</code> - T·∫°o m·ªõi</li><li><span class="api-method method-get">GET</span><code>/api/knowledge-base/{id}</code> - L·∫•y chi ti·∫øt</li><li><span class="api-method method-put">PUT</span><code>/api/knowledge-base/{id}/sharing</code> - C·∫≠p nh·∫≠t chia s·∫ª</li></ul></div>
            <div class="card"><h3>4. Quiz Management</h3><ul><li><span class="api-method method-post">POST</span><code>/api/quizzes/from-file</code> - T·∫°o quiz t·ª´ file</li><li><span class="api-method method-post">POST</span><code>/api/quizzes/from-knowledge</code> - T·∫°o quiz t·ª´ knowledge base</li><li><span class="api-method method-get">GET</span><code>/api/quizzes</code> - L·∫•y danh s√°ch quiz</li><li><span class="api-method method-get">GET</span><code>/api/quizzes/{id}</code> - L·∫•y chi ti·∫øt quiz</li><li><span class="api-method method-put">PUT</span><code>/api/quizzes/{id}/settings</code> - C·∫≠p nh·∫≠t c√†i ƒë·∫∑t</li><li><span class="api-method method-post">POST</span><code>/api/quizzes/{id}/publish</code> - Xu·∫•t b·∫£n quiz</li></ul></div>
            <div class="card"><h3>5. Questions & Answers</h3><ul><li><span class="api-method method-get">GET</span><code>/api/quizzes/{quizId}/questions</code> - L·∫•y c√¢u h·ªèi c·ªßa quiz</li><li><span class="api-method method-post">POST</span><code>/api/quizzes/{quizId}/questions</code> - Th√™m c√¢u h·ªèi m·ªõi</li><li><span class="api-method method-put">PUT</span><code>/api/questions/{id}</code> - C·∫≠p nh·∫≠t c√¢u h·ªèi</li><li><span class="api-method method-post">POST</span><code>/api/questions/{qId}/answers</code> - Th√™m ƒë√°p √°n</li></ul></div>
            <div class="card"><h3>6. Quiz Taking</h3><ul><li><span class="api-method method-get">GET</span><code>/api/quiz/share/{shareLink}</code> - Truy c·∫≠p quiz</li><li><span class="api-method method-post">POST</span><code>/api/quiz/share/{shareLink}/start</code> - B·∫Øt ƒë·∫ßu l√†m b√†i</li><li><span class="api-method method-post">POST</span><code>/api/quiz-attempts/{id}/submit</code> - N·ªôp b√†i</li><li><span class="api-method method-post">POST</span><code>/api/quiz-responses</code> - L∆∞u c√¢u tr·∫£ l·ªùi</li></ul></div>
            <div class="card"><h3>7. Analytics & Statistics</h3><ul><li><span class="api-method method-get">GET</span><code>/api/quizzes/{id}/statistics</code> - Th·ªëng k√™ quiz</li><li><span class="api-method method-get">GET</span><code>/api/quizzes/{id}/leaderboard</code> - B·∫£ng x·∫øp h·∫°ng</li><li><span class="api-method method-get">GET</span><code>/api/users/my-statistics</code> - Th·ªëng k√™ c√° nh√¢n</li></ul></div>
            <div class="card"><h3>8. Semantic Search</h3><ul><li><span class="api-method method-post">POST</span><code>/api/search/quizzes</code> - T√¨m quiz t∆∞∆°ng t·ª±</li><li><span class="api-method method-post">POST</span><code>/api/search/knowledge</code> - T√¨m knowledge base</li><li><span class="api-method method-get">GET</span><code>/api/content/recommended</code> - G·ª£i √Ω n·ªôi dung</li></ul></div>
            <div class="card"><h3>9. Permissions & Sharing</h3><ul><li><span class="api-method method-post">POST</span><code>/api/permissions/grant</code> - C·∫•p quy·ªÅn</li><li><span class="api-method method-delete">DELETE</span><code>/api/permissions/{id}</code> - Thu h·ªìi quy·ªÅn</li><li><span class="api-method method-get">GET</span><code>/api/permissions/my-shared</code> - N·ªôi dung ƒë∆∞·ª£c chia s·∫ª</li></ul></div>
            <div class="card"><h3>10. Real-time (WebSocket)</h3><ul><li><span class="api-method method-ws">WS</span><code>/ws/quiz/{quizId}</code> - C·∫≠p nh·∫≠t real-time</li><li><span class="api-method method-ws">WS</span><code>/ws/quiz/{quizId}/participants</code> - Theo d√µi ng∆∞·ªùi tham gia</li><li><span class="api-method method-ws">WS</span><code>/ws/quiz/{quizId}/leaderboard</code> - C·∫≠p nh·∫≠t b·∫£ng x·∫øp h·∫°ng</li></ul></div>
        </div>
    </div>
</div>

<script>
    // Initialize Mermaid
    mermaid.initialize({
        startOnLoad: true,
        theme: 'base',
        themeVariables: {
            primaryColor: '#f8fafc',
            primaryTextColor: '#334155',
            primaryBorderColor: '#e2e8f0',
            lineColor: '#4f46e5',
            secondaryColor: '#eef2ff',
            tertiaryColor: '#ffffff',
            fontSize: '15px'
        }
    });

    // Tab functionality
    function showTab(tabId) {
        const tabContents = document.querySelectorAll('.tab-content');
        tabContents.forEach(content => content.classList.remove('active'));

        const tabButtons = document.querySelectorAll('.tab-button');
        tabButtons.forEach(button => button.classList.remove('active'));

        document.getElementById(tabId).classList.add('active');

        // Find the button that controls this tab and set it to active
        const activeButton = document.querySelector(`.tab-button[onclick="showTab('${tabId}')"]`);
        if(activeButton) {
            activeButton.classList.add('active');
        }
    }

    // Set the first tab as active on load
    document.addEventListener('DOMContentLoaded', () => {
        document.querySelector('.tab-button').click();
    });
</script>

</body>
</html>
